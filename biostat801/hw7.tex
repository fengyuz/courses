\documentclass{article}

\usepackage{amsmath, amssymb}

\newcommand{\B}{\mathcal{B}}
\newcommand{\dto}{\overset{d}{\to}}

\title{Biostat 801 Homework 7}

\author{David Zhang}

\begin{document}
\maketitle


\begin{enumerate}


\item Since $\B([0,1])$ is generated by $\{[0, a]: a \in [0,1]\}$,
  we just need to show $P_n([0,a]) \to P([0,a]) \quad \forall a \in [0,1]$.
  For every $n \geq 1$, there exists a unique $0 \leq m \leq n$ such that $m/n \leq a \leq (m+1)/n$,
  so $|a - m/n| \leq 1/n$ and $|a - (m+1)/n| \leq 1/n$.
  Then
  \[
    |P_n([0,a]) - P([0,a])| = |m/n - a \text{ or } (m+1)/n - a| \leq 1/n \to 0.
  \]
  Thus $P_n \to P$.
\item Let $X_n$, $Y$, and $(X_n,Y)$ be r.v.'s on $(\Omega_{X_n}, \B_{X_n}, P_{X_n})$ and $(\Omega_Y, \B_Y, P_Y)$, and $(\Omega_{(X_n,Y)}, \B_{(X_n,Y)}, P_{(X_n,Y)})$, respectively, for $n \geq 0$.
  (Treat $X$ as $X_0$ to simplify notations.)
  Since $X_n \perp Y$,
  we have $\Omega_{(X_n, Y)} = \Omega_{X_n} \times \Omega_Y$ and $P_{(X_n,Y)} = P_{X_n} P_Y$.
  Then
  \begin{align*}
    E[ F(X_n) ]
    = & \int P_Y(Y \leq X_n) dP_{X_n}
    = \int \int 1_{[Y \leq X_n]} dP_Y dP_{X_n}
    \\ = & \int 1_{[Y \leq X_n]} dP_{(X_n,Y)}
           = P_{(X_n,Y)} [Y \leq X_n]
  \end{align*}
  by Fubini.
  The result follows trivially.
\item Since $p_n(x) \to p(x)$ uniformly on $[-a,a]$ for all $0 < a < \infty$,
  the uniform convergence holds on any interval with finite endpoints.
  Then
  \begin{align*}
    \int_{a}^b p_n(x) dx \to \int_{a}^b p(x) dx \quad \forall -\infty < a \leq b < \infty.
  \end{align*}
  We show that 
  \begin{align*}
    \int_{-\infty}^b p_n(x) dx \to \int_{-\infty}^b p(x) dx \quad \forall -\infty < b < \infty.
  \end{align*}
  \begin{enumerate}
  \item To show: $\liminf \int_{-\infty}^b p_n(x) dx \geq \int_{-\infty}^b p(x) dx$. \\
    Proof: We have
    \begin{align*}
      \int_{-\infty}^b p_n(x) dx 
      \geq & \int_{a}^b p_n(x) dx && \forall a \in (-\infty, \infty)
      \\ \to & \int_{a}^b p(x) dx && \text{as } n \to \infty
      \\ \to & \int_{-\infty}^b p(x) dx && \text{as } a \to -\infty,
    \end{align*}
    so 
    \[
      \liminf \int_{-\infty}^b p_n(x) dx \geq \int_{-\infty}^b p(x) dx
    \]
  \item To show: $\limsup \int_{-\infty}^b p_n(x) dx \leq \int_{-\infty}^b p(x) dx$.
    Let $\epsilon >0$ and let $c$ be small enough so that $\int_{c}^b p(x) dx > \int_{-\infty}^b p(x) dx - \epsilon$,
    so
    \[
      \int_{c}^b p_n(x) dx > \int_{-\infty}^b p(x) dx - \epsilon \quad \forall n \geq N.
    \]
    Then 
    \[
      \int_{-\infty}^c p_n(x) dx < \epsilon \quad \forall n \geq N.
    \]
    Hence
    \begin{align*}
      \int_{-\infty}^b p_n(x) dx 
      = & \int_{-\infty}^c p_n(x) dx 
      + \int_{c}^b p_n(x) dx 
      \\ \leq & \epsilon + \int_{c}^b p_n(x) dx 
      \\ \to & \epsilon + \int_{c}^b p(x) dx && \text{as } n \to \infty
      \\ \to & \int_{c}^b p(x) dx && \text{as } \epsilon \to 0
      \\ \to & \int_{-\infty}^b p(x) dx && \text{as } c \to -\infty
    \end{align*}
    Thus
    \[
      \limsup \int_{-\infty}^b p_n(x) dx \leq \int_{-\infty}^b p(x) dx.
    \]
  \end{enumerate}
  Therefore, $\int_{-\infty}^b p_n(x) dx \to \int_{-\infty}^b p(x) dx$,
  so $P_n \dto P$.
  \item Since $X_n \overset{L_2}{\to} X$, we have $X_n \overset{L_1}{\to} X$ and therefore $E|X_n - X| \to 0$.
    Then
    \[
      E|X| \leq E|X - X_n| + E|X_n| \leq \epsilon + E|X_n| < \infty
    \]
    for all $n \geq N$.
    Moreover,
    \[
      |EX_n - EX| = |E(X_n - X)| \leq E|X_n - X| \to 0,
    \]
    so $EX_n \to EX$.
\end{enumerate}


\end{document}
